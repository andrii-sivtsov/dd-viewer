!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t||self).DDViewer=e()}(this,function(){var t=/*#__PURE__*/function(){function t(t,e){void 0===e&&(e={}),this.opts=Object.assign({styles:!0,closeOnOverlay:!0,hooks:{open:null,close:null},watchAsyncContent:!1,mount:"auto",ui:{root:{el:"div",class:"ddlb-modal",attrs:{"aria-hidden":"true"}},window:{el:"div",class:"ddlb-modal-window",attrs:{}},img:{el:"img",class:"ddlb-modal-image",attrs:{alt:""}}},template:null,selectors:{root:".ddlb-modal",img:".ddlb-modal-image"}},e),this.selector=t,this._collectElements(),this._mount(),this._bindElements(),this.opts.watchAsyncContent&&this._watchAsync()}var e=t.prototype;return e._collectElements=function(){this.elements=Array.from(document.querySelectorAll(this.selector)).filter(function(t){return t&&1===t.nodeType}),this.elements.length||console.warn("[DDViewer] no elements by selector:",this.selector)},e._mount=function(){if("manual"===this.opts.mount)return this.root=document.querySelector(this.opts.selectors.root),this.imgEl=document.querySelector(this.opts.selectors.img),this.root&&this.imgEl||console.warn("[DDViewer] manual mode: selectors not found"),void this._bindGlobal();var t=document.querySelector(".ddlb-modal");if(t)return this.root=t,this.imgEl=t.querySelector(".ddlb-modal-image"),void this._bindGlobal();var e=null;if("function"==typeof this.opts.template){var o=this.opts.template(this.opts.ui);if("string"==typeof o){var s=document.createElement("div");s.innerHTML=o.trim(),e=s.firstElementChild}else o&&1===o.nodeType&&(e=o)}if(!e){var i=function(t,e,o){void 0===o&&(o={});var s=document.createElement(t);for(var i in e&&(s.className=e),o)s.setAttribute(i,o[i]);return s},n=this.opts.ui,l=i(n.root.el,n.root.class,Object.assign({"aria-hidden":"true"},n.root.attrs)),r=i(n.window.el,n.window.class,n.window.attrs),c=i(n.img.el,n.img.class,n.img.attrs);this.opts.styles&&(l.style.cssText="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.75);z-index:9999;pointer-events:none;opacity:0;transition:opacity .25s ease",c.style.cssText="max-width:100%;max-height:80vh;display:block;object-fit:contain",r.style.cssText="width:min(92vw,1200px);max-height:90vh;overflow:hidden"),r.appendChild(c),l.appendChild(r),e=l}document.body.appendChild(e),this.root=e,this.imgEl=this.root.querySelector("."+this.opts.ui.img.class),this._bindGlobal()},e._bindElements=function(){var t=this;this.elements.forEach(function(e){e.addEventListener("click",function(o){o.preventDefault();var s=e.querySelector("img"),i=s&&s.getAttribute("src");if(!i)return console.warn("[DDViewer] no <img> src inside element");t.open(i)})})},e._bindGlobal=function(){var t=this;this.opts.closeOnOverlay&&this.root.addEventListener("click",function(e){e.target===t.root&&t.close()}),document.addEventListener("keydown",function(e){"true"!==t.root.getAttribute("aria-hidden")&&"Escape"===e.key&&t.close()})},e._watchAsync=function(){var t=this;if("auto"!==this.opts.watchAsyncContent){if("object"==typeof this.opts.watchAsyncContent&&this.opts.watchAsyncContent.button){var e=document.querySelector(this.opts.watchAsyncContent.button);e&&e.addEventListener("click",function(){setTimeout(function(){t._collectElements(),t._bindElements()},50)})}}else new MutationObserver(function(){t._collectElements(),t._bindElements()}).observe(document.body,{childList:!0,subtree:!0})},e.open=function(t){t&&(this.imgEl.src=t,this.root.setAttribute("aria-hidden","false"),this.opts.hooks&&"function"==typeof this.opts.hooks.open?this.opts.hooks.open({root:this.root,img:this.imgEl,src:t}):this.opts.styles?(this.root.style.pointerEvents="auto",this.root.style.opacity="1"):this.root.style.pointerEvents="auto")},e.close=function(){this.opts.hooks&&"function"==typeof this.opts.hooks.close?this.opts.hooks.close({root:this.root,img:this.imgEl}):(this.opts.styles&&(this.root.style.opacity="0"),this.root.setAttribute("aria-hidden","true"),this.root.style.pointerEvents="none")},t}();return"undefined"!=typeof window&&(window.DDViewer=t),t});
